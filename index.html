<!doctype html>
<html lang="fi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>RUMAT.STUDIO</title>
  <meta name="description" content="Luonnosta syntynyt. Reissuissa testattu. Neuleet ja asusteet poluille ja kaupunkiin – istuvat, hengittävät ja kestävät."/>

  <!-- Fontit + Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;600;700&family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- OG -->
  <meta property="og:title" content="RUMAT.STUDIO – Luonnosta syntynyt. Reissuissa testattu.">
  <meta property="og:description" content="Neuleet ja asusteet poluille ja kaupunkiin – istuvat, hengittävät ja kestävät.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://placehold.co/1200x630?text=RUMAT.STUDIO">
  <meta name="twitter:card" content="summary_large_image">

  <style>
    :root{
      --ink:#202020;
      --dark-forest:#0B0F0E;
      --olive:#A1A266;
      --ivory:#F6F6F4;
      --mist:#DEEEEE;
      --gallery:#F6F6F4;
      --footer:#0B0F0E;
      --silhouette:#08110d;
      --silhouette-mid:#0c1a15;
      --silhouette-line:#9fb1a9;
      --header-h:56px;
      --section-gap: clamp(6px, 1vw, 12px); /* hiukan pienempi rako */
      --band-radius: 16px;
    }

    html{ scroll-padding-top: var(--header-h); }

    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;color:#111827;background:#fff}
    .serif{font-family:"Libre Baskerville",serif}
    .shadow-soft{box-shadow:0 6px 20px rgba(0,0,0,.12)}
    .btn{border-radius:9999px;padding:.6rem 1rem;border:1px solid rgb(214,211,209);transition:transform .06s, box-shadow .12s}
    .btn:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.12)}
    .btn-dark{background:#111827;color:#fff;border-color:#111827}
    .chip{font-size:.78rem;padding:.25rem .55rem;border-radius:9999px;border:1px solid rgb(214,211,209);background:#fff}

    /* Aurora (kiinteä tausta) — ei gradienttia */
    .aurora-fixed{
      position:fixed; inset:0; width:100%; height:100%;
      z-index:0; pointer-events:none; display:block;
      background: transparent;
      transform: translateZ(0); backface-visibility:hidden;
      will-change: transform, opacity;
    }
    .site-content{ position:relative; z-index:2; background:transparent; }

    /* Hero */
    .hero{ position:relative; height:100vh; height:100svh; isolation:isolate; overflow:hidden; }
    .hero-overlay{ position:absolute; inset:0; z-index:1; pointer-events:none;
      background: radial-gradient(58% 42% at 50% 18%, rgba(255,255,255,.06), transparent 55%),
                  linear-gradient(to bottom, rgba(0,0,0,.16), rgba(0,0,0,.36) 72%); }

    /* Parallax smooth */
    #hero-text{ will-change:transform; transform:translateZ(0); transition:none !important; }
    @media (prefers-reduced-motion: reduce){ #hero-text{ transform:none !important; } }

    /* Alareunan siluetti */
    .bottom-sil{ position:fixed; left:0; right:0; bottom:-1px; height:160px; z-index:1; pointer-events:none;
      mask-image: linear-gradient(to top, black 72%, transparent 100%);
      -webkit-mask-image: linear-gradient(to top, black 72%, transparent 100%);}
    .bottom-sil svg{ width:100%; height:100%; display:block; }

    /* Savun animaatio */
    .smoke{
      animation:smoke 6s ease-in-out infinite;
      opacity:.6;
      transform-origin:50% 50%;
      transform-box:fill-box;
      will-change:transform,opacity;
    }
    .smoke.s2{ animation-delay:1.4s }
    @keyframes smoke{ 0%{transform:translateY(0) scale(1);opacity:.6} 100%{transform:translateY(-28px) scale(1.4);opacity:0} }

    /* Drawer & Modal */
    .drawer{position:fixed;inset:0;z-index:60;display:none}
    .drawer.open{display:block}
    #menuDrawer .panel{position:absolute;top:0;left:0;right:auto;width:min(420px,90vw);height:100%;background:#fff;box-shadow:10px 0 30px rgba(0,0,0,.2)}
    #cartDrawer .panel{position:absolute;top:0;right:0;left:auto;width:min(420px,90vw);height:100%;background:#fff;box-shadow:-10px 0 30px rgba(0,0,0,.2)}
    .modal{position:fixed;inset:0;z-index:70;display:none}
    .modal.open{display:grid;place-items:center}

    /* Navin mittaus/flicker-fix */
    .nav-measure{ position:absolute !important; visibility:hidden !important; display:flex !important; white-space:nowrap !important; }
    .nav-hidden{ position:absolute !important; left:-9999px !important; visibility:hidden !important; }

    /* Tuotekuvagalleria: 1 kuva oletuksena, 2 kuvaa kun tila riittää */
    .product-gallery{
      container-type:inline-size;
      --pg-gap:1rem;
    }
    .pg-grid{
      display:grid;
      grid-template-columns:1fr;
      gap:var(--pg-gap);
      justify-items:center;
    }
    .pg-b{ display:none; }
    .pg-grid > .img-wrap{
      width:100%;
      max-width: calc(50cqw - var(--pg-gap)/2); /* yksipalsta = max puolikas leveys */
    }
    @container (min-width: 900px){
      .product-gallery{ --pg-gap:1.5rem; }
      .pg-grid{ grid-template-columns:repeat(2,minmax(0,1fr)); gap:var(--pg-gap); }
      .pg-b{ display:block; }
      .pg-grid > .img-wrap{ max-width:none; }
    }

    /* MYYTY-overlay */
    .img-wrap{ position:relative; }
    .sold-badge{
      position:absolute; inset:0; display:grid; place-items:center;
      background:rgba(8,17,13,.72); color:#fff; font-weight:800; font-size:1.05rem;
      letter-spacing:.12em; text-transform:uppercase;
    }
    .sold-chip{
      display:inline-block; margin-top:.35rem; padding:.25rem .55rem;
      border-radius:9999px; background:#111827; color:#fff; font-size:.75rem; letter-spacing:.08em;
    }

    /* Revontuliraot */
    .aurora-gap{
      height: var(--section-gap);
      pointer-events: none;
      background: transparent;
    }

    /* Pyöristetyt palkit (bandit) */
    .full-bleed{
      margin-left: calc(50% - 50vw);
      margin-right: calc(50% - 50vw);
    }
    .band{
      background:#fff;
      border-radius: var(--band-radius);
      overflow: hidden;
    }
    .band--mist{ background: var(--mist); }
    .band--stone{ background: #f5f5f4; }
    .band-inner{ max-width: 72rem; margin: 0 auto; padding: 3rem 1rem; } /* = max-w-6xl + py-12 px-4 */
  </style>
</head>

<body class="text-stone-900">
  <!-- KIINTEÄ REVONTULI-TAUSTA -->
  <canvas id="auroraCanvas" class="aurora-fixed"></canvas>

  <!-- ALAREUNAN SILUETTI -->
  <div class="bottom-sil" aria-hidden="true">
    <svg viewBox="0 0 1440 160" preserveAspectRatio="xMidYMax slice">
      <defs>
        <g id="treeTall" fill="var(--silhouette)">
          <path d="M0,0 l-18,22 h36 z" transform="translate(0,0)"/>
          <path d="M0,0 l-20,24 h40 z" transform="translate(0,10)"/>
          <path d="M0,0 l-22,26 h44 z" transform="translate(0,22)"/>
          <path d="M0,0 l-26,32 h52 z" transform="translate(0,34)"/>
        </g>
        <g id="treeMed" fill="var(--silhouette)">
          <path d="M0,0 l-14,18 h28 z" transform="translate(0,2)"/>
          <path d="M0,0 l-16,20 h32 z" transform="translate(0,12)"/>
          <path d="M0,0 l-20,26 h40 z" transform="translate(0,22)"/>
        </g>
        <g id="treeSmall" fill="var(--silhouette)">
          <path d="M0,0 l-11,14 h22 z" transform="translate(0,4)"/>
          <path d="M0,0 l-15,20 h30 z" transform="translate(0,12)"/>
        </g>
      </defs>

      <!-- Vuoriharjanteet -->
      <path d="M0,120 C180,105 240,108 340,114 C460,121 520,110 640,116 C760,122 880,108 1000,114 C1160,122 1280,110 1440,118 L1440,160 L0,160 Z" fill="var(--silhouette-mid)" opacity=".28"/>
      <path d="M0,122 C120,118 190,110 260,118 C340,126 420,106 500,116 C580,126 670,108 760,120 C850,132 980,110 1100,118 C1220,126 1330,112 1440,120 L1440,160 L0,160 Z" fill="var(--silhouette-mid)" opacity=".44"/>
      <path d="M0,130 C160,128 320,132 480,130 C640,128 800,131 960,129 C1120,128 1280,131 1440,129 L1440,160 L0,160 Z" fill="var(--silhouette)"/>

      <!-- Kuuset -->
      <g>
        <use href="#treeTall"  transform="translate(55,76) scale(0.75)"/>
        <use href="#treeMed"   transform="translate(95,82) scale(0.75)"/>
        <use href="#treeSmall" transform="translate(128,88) scale(0.75)"/>
        <use href="#treeTall"  transform="translate(168,74) scale(0.75)"/>
        <use href="#treeMed"   transform="translate(210,82) scale(0.75)"/>

        <use href="#treeTall"  transform="translate(520,74) scale(0.75)"/>
        <use href="#treeMed"   transform="translate(558,82) scale(0.75)"/>
        <use href="#treeSmall" transform="translate(592,88) scale(0.75)"/>
        <use href="#treeTall"  transform="translate(632,72) scale(0.75)"/>
        <use href="#treeMed"   transform="translate(674,82) scale(0.75)"/>
        <use href="#treeSmall" transform="translate(706,90) scale(0.75)"/>
        <use href="#treeTall"  transform="translate(748,74) scale(0.75)"/>
        <use href="#treeMed"   transform="translate(786,82) scale(0.75)"/>

        <use href="#treeTall"  transform="translate(1086,76) scale(0.75)"/>
        <use href="#treeMed"   transform="translate(1122,84) scale(0.75)"/>
        <use href="#treeSmall" transform="translate(1156,90) scale(0.75)"/>

        <use href="#treeMed"   transform="translate(1300,84) scale(0.75)"/>
        <use href="#treeSmall" transform="translate(1340,90) scale(0.75)"/>
        <use href="#treeTall"  transform="translate(1380,76) scale(0.75)"/>
      </g>

      <!-- Mökki -->
      <g>
        <rect x="1203" y="115" width="44" height="22" rx="1" fill="var(--silhouette)"/>
        <path d="M1198,116 L1225,100 L1252,116 Z" fill="var(--silhouette)"/>
        <rect x="1232" y="102" width="6" height="12" fill="var(--silhouette)"/>
      </g>

      <!-- Savu -->
      <g fill="#b7c7c1">
        <circle class="smoke"  cx="1235" cy="98" r="2.8"/>
        <circle class="smoke s2" cx="1239" cy="93" r="2.2"/>
      </g>
    </svg>
  </div>

  <!-- HEADER -->
  <header class="fixed top-0 left-0 right-0 z-50">
    <div class="relative bg-[color:var(--dark-forest)] text-white">
      <div id="hdrRow" class="mx-auto max-w-6xl px-4 py-3 grid grid-cols-[1fr_auto_1fr] items-center gap-3">
        <a id="brandBlock" href="#etusivu" class="flex items-center gap-3">
          <img alt="RUMAT.STUDIO logo" class="h-9 w-9 object-contain" src="assets/logo.svg">
          <span class="hidden sm:block text-sm uppercase tracking-widest font-semibold">RUMAT.STUDIO</span>
          <button id="openMenu" class="ml-2 px-3 py-2 rounded-full bg-white/10 ring-1 ring-white/30 hover:bg-white/20 hidden"
                  aria-controls="menuDrawer" aria-expanded="false">Valikko</button>
        </a>

        <nav id="mainNav" class="justify-self-center flex items-center gap-6 text-[13px] uppercase tracking-widest">
          <a href="#etusivu"   class="hover:underline underline-offset-4 font-semibold">Etusivu</a>
          <a href="#tuotteet"  class="hover:underline underline-offset-4 font-semibold">Tuotteet</a>
          <a href="#tarina"    class="hover:underline underline-offset-4 font-semibold">Tarina</a>
          <a href="#blogi"     class="hover:underline underline-offset-4 font-semibold">Blogi</a>
          <a href="#some"      class="hover:underline underline-offset-4 font-semibold">Some</a>
          <a href="#yhteys"    class="hover:underline underline-offset-4 font-semibold">Yhteystiedot</a>
        </nav>

        <div id="rightBlock" class="justify-self-end flex items-center gap-2">
          <button id="openCart" class="px-3 py-2 rounded-full bg-white/10 ring-1 ring-white/30 hover:bg-white/20">
            Ostoskori (<span id="cartCount">0</span>)
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- SISÄLTÖ -->
  <main class="site-content">
    <!-- HERO -->
    <section id="etusivu" class="hero grid place-items-center text-stone-50 px-4">
      <div class="hero-overlay"></div>
      <div id="hero-text" class="text-center mt-24 md:mt-28">
        <h1 class="serif font-semibold tracking-[0.08em] text-[clamp(22px,4.8vw,58px)]
                   drop-shadow-[0_2px_16px_rgba(0,0,0,0.40)]">
          Liian rumat ollakseen totta
        </h1>
        <div class="mt-8 flex justify-center">
          <img alt="RUMAT.STUDIO logo" class="h-24 w-24 sm:h-28 sm:w-28 object-contain" src="assets/logo.svg">
        </div>
      </div>
    </section>

    <!-- Esittely (pyöristetty valkoinen bandi) -->
    <section class="py-0">
      <div class="band full-bleed">
        <div class="band-inner text-center">
          <p id="intro-text" class="text-xl sm:text-2xl">
            <strong>Luonnosta syntynyt. Reissuissa testattu.</strong>
            Suunnittelemani neuleet ja asusteet kulkevat mukana poluilla ja kaupungissa – jotta sinulla on päälläsi jotain, joka istuu, hengittää ja kestää jokaisella askeleella.
          </p>
        </div>
      </div>
    </section>
    <div class="aurora-gap full-bleed"></div>

    <!-- TUOTTEET -->
    <section id="tuotteet" class="py-0">
      <div id="productsRoot"></div>
    </section>

    <!-- BLOGI (sumu-tausta, pyöristetty) -->
    <section id="blogi" class="py-0">
      <div class="band band--mist full-bleed">
        <div class="band-inner">
          <h2 class="serif text-3xl mb-6">Blogi</h2>
          <div id="blogRoot" class="grid gap-6"></div>
        </div>
      </div>
    </section>
    <div class="aurora-gap full-bleed"></div>

    <!-- SOME (valkoinen, pyöristetty) -->
    <section id="some" class="py-0">
      <div class="band full-bleed">
        <div class="band-inner">
          <h2 class="serif text-3xl mb-6">Some</h2>
          <div class="grid md:grid-cols-2 gap-6">
            <div class="aspect-[9/16] rounded-xl ring-1 ring-stone-200 overflow-hidden bg-black">
              <iframe id="igEmbed" class="w-full h-full" allowtransparency="true" frameborder="0" scrolling="no" loading="lazy"
                      src="https://www.instagram.com/p/DMXVRgGC1Bv/embed" style="display:block"></iframe>
            </div>
            <div class="aspect-[9/16] rounded-xl ring-1 ring-stone-200 overflow-hidden bg-black">
              <iframe id="ttEmbed"
                src="https://www.tiktok.com/embed/v2/7525414518562753814"
                style="width:100%;height:100%;border:0;display:block"
                allow="encrypted-media;"
                allowfullscreen
                title="TikTok video"></iframe>
            </div>
          </div>
        </div>
      </div>
    </section>
    <div class="aurora-gap full-bleed"></div>

    <!-- TARINA (stone-50, pyöristetty) -->
    <section id="tarina" class="py-0">
      <div class="band band--stone full-bleed">
        <div class="band-inner">
          <h2 class="serif text-3xl mb-4">Tarina</h2>
          <p id="story">
            Pienet erät. Kestävä käyttö. Pohjoiset sävyt. Valmistamme pieniä eriä Suomessa ja EU:ssa, jotta vaate kestää vuosia ja tekijät näkyvät.
          </p>
        </div>
      </div>
    </section>
    <div class="aurora-gap full-bleed"></div>

    <!-- FOOTER -->
    <footer id="yhteys" class="pt-14 text-[color:var(--ivory)]" style="background:var(--footer)">
      <div class="mx-auto max-w-6xl px-4 grid sm:grid-cols-3 gap-8">
        <div>
          <div class="uppercase tracking-wide">RUMAT.STUDIO</div>
          <div id="tagline" class="text-sm mt-1 text-white/70">Suomussalmi — Contemporary textiles, built to last.</div>
        </div>
        <div>
          <h5 class="text-sm text-white/70">Yhteys</h5>
          <ul class="mt-2 space-y-2 text-sm">
            <li><a id="mailLink" href="mailto:hello@rumat.fi" class="hover:underline">hello@rumat.fi</a></li>
            <li><a id="igLink" href="https://instagram.com/rumat.studio" target="_blank" rel="noreferrer" class="hover:underline">Instagram</a></li>
            <li><a id="ttLink" href="https://www.tiktok.com/@rumat.studio" target="_blank" rel="noreferrer" class="hover:underline">TikTok</a></li>
            <li id="location">Kauppakatu 20, 89600 Suomussalmi</li>
          </ul>
        </div>
        <div>
          <h5 class="text-sm text-white/70">Toimitus</h5>
          <ul class="mt-2 space-y-2 text-sm" id="shipInfo">
            <li>Toimitus valitaan kassalla</li>
            <li>Nouto (sovitusti) — 0 €</li>
            <li>Posti — 6,90 €</li>
          </ul>
        </div>
      </div>
      <div class="py-8 text-center text-xs text-white/65">© <span id="year"></span> RUMAT.STUDIO</div>
    </footer>
  </main>

  <!-- OSTOSKORI -->
  <div id="cartDrawer" class="drawer" aria-hidden="true">
    <div class="absolute inset-0 bg-black/40" id="closeCart" aria-label="Sulje ostoskori"></div>
    <div class="panel p-5 flex flex-col">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-xl font-semibold">Ostoskori</h3>
        <button id="closeCartX" class="text-stone-500 hover:text-stone-800">✕</button>
      </div>
      <div id="cartItems" class="flex-1 overflow-auto divide-y"></div>
      <div class="mt-4 space-y-3">
        <div>
          <div class="text-sm font-medium mb-1">Toimitus</div>
          <div id="shipOptions" class="space-y-1"></div>
        </div>
        <div class="text-sm grid grid-cols-2 gap-y-1">
          <div class="text-stone-600">Välisumma</div><div class="text-right" id="subTotal">€0,00</div>
          <div class="text-stone-600">Toimitus</div><div class="text-right" id="shipTotal">€0,00</div>
          <div class="font-semibold">Yhteensä</div><div class="text-right font-semibold" id="grandTotal">€0,00</div>
        </div>
        <button id="checkout" class="btn btn-dark w-full">Maksa PayPalilla</button>
        <div id="paypalWarn" class="text-xs text-stone-500"></div>
      </div>
    </div>
  </div>

  <!-- VALIKKO (vasemmalta) -->
  <div id="menuDrawer" class="drawer" aria-hidden="true">
    <div class="absolute inset-0 bg-black/40" id="closeMenu" aria-label="Sulje valikko"></div>
    <div class="panel p-6 flex flex-col gap-4">
      <div class="flex items-center justify-between">
        <h3 class="text-xl font-semibold">Valikko</h3>
        <button id="closeMenuX" class="text-stone-500 hover:text-stone-800">✕</button>
      </div>
      <nav class="flex flex-col gap-3 text-lg">
        <a href="#etusivu"   class="py-2 border-b" data-menu-close>Etusivu</a>
        <a href="#tuotteet"  class="py-2 border-b" data-menu-close>Tuotteet</a>
        <a href="#tarina"    class="py-2 border-b" data-menu-close>Tarina</a>
        <a href="#blogi"     class="py-2 border-b" data-menu-close>Blogi</a>
        <a href="#some"      class="py-2 border-b" data-menu-close>Some</a>
        <a href="#yhteys"    class="py-2"          data-menu-close>Yhteystiedot</a>
      </nav>
    </div>
  </div>

  <!-- SUCCESS/CANCEL MODAL -->
  <div id="resultModal" class="modal">
    <div class="bg-white rounded-2xl p-6 shadow-soft w-[min(92vw,480px)] text-center">
      <h3 id="resultTitle" class="serif text-2xl mb-2">Kiitos tilauksesta!</h3>
      <p id="resultText" class="text-stone-600">Vahvistus saapuu sähköpostiisi.</p>
      <a href="#" class="btn btn-dark mt-4 inline-block">Takaisin etusivulle</a>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script>
  const API_BASE = "";
  const fmtEUR = x => new Intl.NumberFormat('fi-FI',{style:'currency',currency:'EUR'}).format(x);
  const $ = sel => document.querySelector(sel);
  const el = (tag,attrs={},...kids)=>{
    const n=document.createElement(tag);
    Object.entries(attrs).forEach(([k,v])=>{
      if(k==='class') n.className=v;
      else if(k==='html') n.innerHTML=v;
      else if(k.startsWith('on')) n.addEventListener(k.slice(2),v);
      else n.setAttribute(k,v);
    });
    kids.forEach(k=>{
      if(k==null) return;
      if(Array.isArray(k)) k.forEach(kk=>{ if(kk!=null) n.appendChild(typeof kk==='string'?document.createTextNode(kk):kk); });
      else if(typeof k==='string') n.appendChild(document.createTextNode(k));
      else n.appendChild(k);
    });
    return n;
  };

  // Hero-tekstin liike – rAF-throttled, pikseleissä
  (function(){
    const hero   = document.getElementById('etusivu');
    const textEl = document.getElementById('hero-text');
    const yearEl = document.getElementById('year');
    if (yearEl) yearEl.textContent = new Date().getFullYear();

    let heroTop = 0, heroHeight = 1, amplitudePx = 0;
    let ticking = false, lastScrollY = 0, reduceMotion = false;

    function recalc(){
      const rect = hero.getBoundingClientRect();
      heroTop = rect.top + (window.scrollY || window.pageYOffset || 0);
      heroHeight = Math.max(1, hero.offsetHeight);
      amplitudePx = heroHeight * 0.18; // ~18vh
    }
    const clamp = (v,min,max)=>Math.min(max,Math.max(min,v));
    const easeOutQuad = t => 1 - (1 - t) * (1 - t);

    function update(){
      ticking = false;
      if (reduceMotion){ textEl.style.transform = 'translate3d(0,0,0)'; return; }
      const y = lastScrollY;
      const p = clamp((y - heroTop) / heroHeight, 0, 1);
      const eased = easeOutQuad(clamp(p / 0.9, 0, 1));
      const ty = -amplitudePx * eased;
      textEl.style.transform = `translate3d(0, ${ty}px, 0)`;
    }
    function onScroll(){ lastScrollY = window.scrollY || window.pageYOffset || 0; if (!ticking){ ticking = true; requestAnimationFrame(update); } }
    function onResize(){ recalc(); onScroll(); }

    const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
    reduceMotion = mq.matches;
    mq.addEventListener?.('change', e => { reduceMotion = e.matches; onScroll(); });

    window.addEventListener('scroll', onScroll, {passive:true});
    window.addEventListener('resize', ()=>requestAnimationFrame(onResize), {passive:true});
    if (window.visualViewport){ window.visualViewport.addEventListener('resize', ()=>requestAnimationFrame(onResize), {passive:true}); }
    if ('fonts' in document){ document.fonts.ready.then(()=>{ recalc(); onScroll(); }); }
    recalc(); onScroll();
  })();

  // ----- CMS / sisältö -----
  const defaultContent = {
    hero:{ headline:"Liian rumat ollakseen totta" },
    paypalBusiness:"",
    contact:{
      email:"hello@rumat.fi",
      instagram:"https://instagram.com/rumat.studio",
      tiktok:"https://www.tiktok.com/@rumat.studio",
      location:"Kauppakatu 20, 89600 Suomussalmi"
    },
    embed:{ instagramPost:"https://www.instagram.com/p/DMXVRgGC1Bv/embed", tiktokVideo:"https://www.tiktok.com/@rumat.studio/video/7525414518562753814" },
    pitch:"Luonnosta syntynyt. Reissuissa testattu. Suunnittelemani neuleet ja asusteet kulkevat mukana poluilla ja kaupungissa – jotta sinulla on päälläsi jotain, joka istuu, hengittää ja kestää jokaisella askeleella.",
    products:[
      { id:"laukku", name:"Laukku", price:149.00, blurb:"Täysin kierrätysmateriaaleista valmistettu sling-laukku. Kierrätetty purjekangas/tekstiili, hihna käytetystä turvavyöstä, metalliosat uudelleenkäytettyä varastoa. Ulkomitat: 28 × 16 × 7 cm. Valmistettu Suomessa.", images:[
        "https://images.unsplash.com/photo-1548036328-c9fa89d128fa?auto=format&fit=crop&w=1600&q=80",
        "https://images.unsplash.com/photo-1520975922321-6ca0a0a5a0d3?auto=format&fit=crop&w=1600&q=80",
        "https://images.unsplash.com/photo-1511389026070-a14ae610a1be?auto=format&fit=crop&w=1600&q=80"
      ]},
      { id:"pipo", name:"RUMAT Pipo", price:59.00, blurb:"Käsinneulottu mohair-sekoite. Korkeus n. 22 cm. Päänympärys 54–58 cm (joustava).", images:[
        "https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1600&q=80",
        "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=1600&q=80",
        "https://images.unsplash.com/photo-1503341455253-b2e723bb3dbb?auto=format&fit=crop&w=1600&q=80"
      ]}
    ],
    payment:{ shipping:{ methods:[
      { id:"PICKUP", name:"Nouto (sovitusti)", price:"€0,00" },
      { id:"POSTI",  name:"Posti",             price:"€6,90" }
    ], defaultMethodId:"PICKUP" } },
    blog:[{ title:"Matka rumaan kauneuteen", body:"Olen aina etsinyt materiaaleja, jotka kestävät oikeaa elämää: reissujen sateet, rinkan hiertämät olkaimet, kaupunkipäivien nopeat käännökset. RUMAT syntyi siitä, että vaatteiden pitää tehdä työnsä — hengittää, istua ja kestää — ilman turhaa selittelyä. Kaikki mallini syntyvät metsässä ja kaupungissa testaten, kunnes ne toimivat juuri niin kuin pitää." }]
  };

  let CONTENT = structuredClone(defaultContent);

  async function loadContent(){
    if(!API_BASE){ applyContent(CONTENT); return; }
    try{
      const r = await fetch(`${API_BASE}/api/content`, {credentials:'include'});
      if(r.ok){ const d = await r.json(); CONTENT = Object.assign({}, CONTENT, d); }
    }catch(e){ console.warn("Sisällön haku epäonnistui", e); }
    applyContent(CONTENT);
  }

  function priceNum(s){ if(typeof s==='number') return s; const m=String(s||"").replace(/\s/g,"").match(/([0-9]+(?:[.,][0-9]{1,2})?)/); return m?parseFloat(m[1].replace(',','.')):0; }
  function parseTikTokId(url){ const m=String(url||"").match(/video\/(\d+)/); return m?m[1]:null; }

  function applyContent(d){
    const h1 = document.querySelector('#hero-text h1');
    if(d?.hero?.headline && h1) h1.textContent = d.hero.headline;
    const intro = document.getElementById('intro-text');
    if(d?.pitch && intro) intro.textContent = d.pitch;
    const story = document.getElementById('story');
    if(d?.story && story) story.textContent = d.story;

    if(d?.contact?.email){ const ml=$('#mailLink'); if(ml){ ml.href=`mailto:${d.contact.email}`; ml.textContent=d.contact.email; } }
    if(d?.contact?.instagram){ const ig=$('#igLink'); if(ig) ig.href=d.contact.instagram; }
    if(d?.contact?.tiktok){ const tt=$('#ttLink'); if(tt) tt.href=d.contact.tiktok; }
    if(d?.contact?.location){ const loc=$('#location'); if(loc) loc.textContent = d.contact.location; }

    if(d?.embed?.instagramPost){ const ig=$('#igEmbed'); if(ig) ig.src = d.embed.instagramPost; }
    if(d?.embed?.tiktokVideo){ const id=parseTikTokId(d.embed.tiktokVideo); const tt=$('#ttEmbed'); if(id&&tt){ tt.src=`https://www.tiktok.com/embed/v2/${id}`; } }

    renderProducts(d.products || defaultContent.products);

    const methods = d?.payment?.shipping?.methods || defaultContent.payment.shipping.methods;
    const defId   = d?.payment?.shipping?.defaultMethodId || methods[0]?.id;
    renderShipping(methods, defId);

    renderBlog(d.blog || defaultContent.blog);

    const warn = $('#paypalWarn'); if(warn) warn.textContent = d.paypalBusiness ? "" : "Aseta PayPal-sähköposti backendissä (ADMIN) ennen julkaisuversiota.";
  }

  function renderBlog(posts){
    const root = document.getElementById('blogRoot');
    if(!root) return;
    root.innerHTML='';
    posts.forEach(p=>{
      root.appendChild(
        el('article',{class:'bg-white rounded-xl ring-1 ring-stone-200 p-6 md:p-8'},
          el('h3',{class:'text-2xl font-semibold mb-2'}, p.title||'Postaus'),
          el('p',{class:'text-stone-700'}, p.body||'')
        )
      );
    });
  }

  // ===== Yksittäiskappale-logiikka (MYYTY) =====
  let SOLD = JSON.parse(localStorage.getItem('sold') || '{}'); // { [productId]: true }
  function saveSold(){ localStorage.setItem('sold', JSON.stringify(SOLD)); }
  function isSold(id){
    const fromContent = (CONTENT.products || []).find(x=>x.id===id)?.sold === true;
    return !!(SOLD[id] || fromContent);
  }
  function markSold(ids=[]){ ids.forEach(id=>SOLD[id]=true); saveSold(); }

  // ===== Tuotteet =====
  function renderProducts(list){
    const root = document.getElementById('productsRoot');
    if(!root) return;
    root.innerHTML = "";

    list.forEach((p,idx)=>{
      const pairId = `pair-${idx}`;
      const leftId=`${pairId}-a`, rightId=`${pairId}-b`;
      const prevId=`${pairId}-prev`, nextId=`${pairId}-next`;
      const sold = isSold(p.id);

      const gallery = el('div',{
          class:'product-gallery rounded-xl',
          style:`background:${getComputedStyle(document.documentElement).getPropertyValue('--gallery')||'#F6F6F4'}`
        },
        el('div',{class:'relative'},
          el('div',{class:'pg-grid'},
            el('div',{class:'img-wrap aspect-[4/5] overflow-hidden rounded-xl ring-1 ring-stone-200'},
              el('img',{id:leftId,class:'w-full h-full object-cover',alt:`${p.name} kuva 1`,loading:'lazy',decoding:'async'}),
              sold ? el('div',{class:'sold-badge'}, 'MYYTY') : null
            ),
            el('div',{class:'pg-b img-wrap aspect-[4/5] overflow-hidden rounded-xl ring-1 ring-stone-200'},
              el('img',{id:rightId,class:'w-full h-full object-cover',alt:`${p.name} kuva 2`,loading:'lazy',decoding:'async'}),
              sold ? el('div',{class:'sold-badge'}, 'MYYTY') : null
            )
          ),
          el('button',{id:prevId,disabled:sold,class:'absolute left-2 top-1/2 -translate-y-1/2 p-3 rounded-full bg-white/90 backdrop-blur border border-stone-300 shadow-soft' + (sold?' opacity-50 cursor-not-allowed':''),ariaLabel:'Edelliset kuvat'},'◀'),
          el('button',{id:nextId,disabled:sold,class:'absolute right-2 top-1/2 -translate-y-1/2 p-3 rounded-full bg-white/90 backdrop-blur border border-stone-300 shadow-soft' + (sold?' opacity-50 cursor-not-allowed':''),ariaLabel:'Seuraavat kuvat'},'▶')
        )
      );

      const details = el('div',{class:'mt-6 text-center'},
        el('h3',{class:'serif text-2xl'}, p.name||'Tuote'),
        el('p',{class:'mt-1 text-stone-700 max-w-2xl mx-auto'}, p.blurb||''),
        el('div',{class:'mt-2 font-semibold text-lg'}, fmtEUR(Number(p.price||0))),
        sold ? el('div',{class:'sold-chip', 'aria-label':'Myyty'}, 'MYYTY') :
               el('div',{class:'mt-3'}, el('button',{'data-buy':p.id,class:'btn btn-dark'},'Osta'))
      );

      const wrap = el('div',{}, gallery, details);

      // Header vain ensimmäiseen bandiin
      let headerRow = null;
      if (idx === 0){
        headerRow = el('div',{class:'flex items-center justify-between mb
